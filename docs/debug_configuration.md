# Конфигурация отладки для VSCode

## Проблема с отладкой консольных приложений

При отладке Dart-приложений, использующих стандартный ввод (stdin.readLineSync()), в VSCode возникает проблема: функция чтения ввода не работает корректно в debug console. Это связано с тем, что отладчик не перенаправляет стандартный ввод в debug console должным образом.

Для решения этой проблемы необходимо настроить конфигурацию запуска таким образом, чтобы использовать интегрированный терминал VSCode вместо debug console.

## Описание файла launch.json

Файл `.vscode/launch.json` используется для настройки конфигураций отладки в Visual Studio Code. Он позволяет определить, как запускать и отлаживать приложения, указывая параметры запуска, окружение, аргументы командной строки и другие настройки.

## Структура файла

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Movement Demo Debug",
      "request": "launch",
      "type": "dart",
      "program": "${workspaceFolder}/bin/movement_demo.dart",
      "console": "integratedTerminal",
      "cwd": "${workspaceFolder}",
      "args": [],
      "env": {}
    }
 ]
}
```

## Параметры конфигурации

### Обязательные параметры

- `name` - название конфигурации, которое отображается в списке конфигураций отладки
- `request` - тип запроса ("launch" для запуска нового процесса)
- `type` - тип отладчика ("dart" для Dart приложений)
- `program` - путь к исполняемому файлу Dart

### Важные параметры для работы с stdin

- `console` - определяет тип консоли для вывода:
  - `"externalTerminal"` - открывает внешний терминал (рекомендуется для работы с stdin в отладке)
  - `"integratedTerminal"` - использует интегрированный терминал VSCode
  - `"internalConsole"` - внутренняя консоль отладки (не поддерживает stdin)

### Дополнительные параметры:
- `cwd` - рабочая директория для запуска приложения
- `args` - массив аргументов командной строки
- `env` - переменные окружения

## Настройка для работы с stdin

Для корректной работы с вводом с клавиатуры (stdin.readLineSync()) важно установить:

```json
"console": "externalTerminal"
```

Этот параметр обеспечивает открытие внешнего терминала для отладки, что позволяет пользователю вводить данные во время отладки.

## Использование

1. Убедитесь, что файл `.vscode/launch.json` находится в корневой директории проекта
2. Откройте VSCode в корневой директории проекта
3. Перейдите в режим отладки (Ctrl+Shift+D)
4. Выберите нужную конфигурацию из выпадающего списка
5. Нажмите F5 для запуска отладки

После запуска в integratedTerminal будет работать полноценный интерактивный ввод-вывод, и функция `stdin.readLineSync()` будет корректно получать введенные пользователем данные.

## Создание нескольких конфигураций

Можно создать несколько конфигураций для разных сценариев:

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Movement Demo Debug",
      "request": "launch",
      "type": "dart",
      "program": "${workspaceFolder}/bin/movement_demo.dart",
      "console": "integratedTerminal",
      "dartConsole": "terminal"
    },
    {
      "name": "Movement Demo Run",
      "request": "launch",
      "type": "dart",
      "program": "${workspaceFolder}/bin/movement_demo.dart",
      "console": "integratedTerminal",
      "noDebug": true,
      "dartConsole": "terminal"
    }
  ]
}
```

Вторая конфигурация запускает приложение без отладки, что также может быть полезно для тестирования интерактивности.

## Решение проблемы с stdin в отладке

Как упоминалось выше, стандартный отладчик VSCode не позволяет корректно считывать ввод с клавиатуры через stdin.readLineSync(). Использование параметра `"console": "externalTerminal"` в конфигурации запуска решает эту проблему, позволяя приложению взаимодействовать с пользователем через внешний терминал во время отладки.

Для более подробной информации о проекте и его возможностях, смотрите основной файл документации [`README.md`](../README.md).


## Альтернативные решения проблемы

Если даже после настройки конфигурации отладки в VSCode функция `stdin.readLineSync()` не работает корректно в debug console, можно использовать следующие альтернативные подходы:

1. **Запуск без отладки**: Вместо отладки можно использовать режим "Run Without Debugging" (Ctrl+F5), который также использует интегрированный терминал и позволяет корректно работать с вводом.

2. **Использование внешнего терминала**: В некоторых случаях можно настроить запуск в внешнем терминале, установив `"console": "externalTerminal"` в конфигурации, хотя это может быть менее удобным.

3. **Временное использование асинхронного ввода**: В процессе разработки можно временно изменить код для использования асинхронного чтения ввода, хотя это требует изменений в логике приложения.
